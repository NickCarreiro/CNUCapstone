{% extends "base.html" %}
{% block body_class %}page-login{% endblock %}
{% block content %}
<section class="card auth-card">
  <div class="eyebrow">Secure Recovery</div>
  <h1>Reset password</h1>
  <p class="muted">Account: <code>{{ username }}</code>. Complete MFA and set a new password.</p>
  {% if notice %}
  <div class="alert admin-notice">{{ notice }}</div>
  {% endif %}
  {% if error %}
  <div class="alert">{{ error }}</div>
  {% endif %}
  <form method="post" action="/ui/forgot-password/mfa" class="form">
    <input type="hidden" name="pending_token" value="{{ pending_token }}" />
    <label>
      <span>MFA method</span>
      <select name="mfa_method">
        {% for method in mfa_methods %}
        <option value="{{ method.value }}" {% if mfa_method == method.value %}selected{% endif %}>{{ method.label }}</option>
        {% endfor %}
      </select>
    </label>
    <label>
      <span>MFA code</span>
      <input type="text" name="mfa_code" inputmode="numeric" pattern="[0-9]*" autocomplete="one-time-code" />
    </label>
    <label>
      <span>New password</span>
      <input type="password" name="new_password" minlength="10" />
    </label>
    <label>
      <span>Confirm new password</span>
      <input type="password" name="confirm_password" minlength="10" />
    </label>
    <div class="modal-actions">
      <button type="submit">Reset password</button>
      <button type="submit" class="ghost" name="send_mfa_code" value="1">Send code</button>
    </div>
  </form>
  <p class="muted helper-link">
    Need to start over? <a href="/ui/forgot-password">Back to recovery start</a>
  </p>
</section>
{% endblock %}
